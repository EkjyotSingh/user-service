{"openapi":"3.0.0","paths":{"/":{"get":{"description":"Returns a simple hello message to verify the API is running","operationId":"AppController_getHello","parameters":[],"responses":{"200":{"description":"API is running","content":{"application/json":{"schema":{"example":"Hello World!"}}}}},"summary":"Health check","tags":["Health"]}},"/auth/login":{"post":{"description":"Supports phone (OTP) and email/password login","operationId":"AuthController_login","parameters":[{"name":"x-forwarded-for","in":"header","description":"Client IP address (optional, can also be detected automatically)","required":false,"schema":{"type":"string"}},{"name":"x-device-id","in":"header","description":"Device ID (optional)","required":false,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LoginDto"}}}},"responses":{"200":{"description":"Login successful. Returns OTP ID for phone login and email login."},"401":{"description":"Invalid credentials"}},"summary":"Login with phone or email","tags":["Authentication"]}},"/auth/social-login":{"post":{"description":"Login using social providers like Google or Apple","operationId":"AuthController_socialLogin","parameters":[{"name":"x-forwarded-for","in":"header","description":"Client IP address (optional, can also be detected automatically)","required":false,"schema":{"type":"string"}},{"name":"x-device-id","in":"header","description":"Device ID","required":true,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SocialLoginDto"}}}},"responses":{"200":{"description":"Social login successful. Returns access and refresh tokens."},"401":{"description":"Invalid social token"}},"summary":"Social login (Google, Apple)","tags":["Authentication"]}},"/auth/request-password-reset":{"post":{"description":"Request OTP code to reset password for email-based accounts","operationId":"AuthController_requestPasswordReset","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RequestPasswordResetDto"}}}},"responses":{"200":{"description":"Password reset OTP sent to email"},"400":{"description":"Invalid request or account not found"}},"summary":"Request password reset","tags":["Authentication"]}},"/auth/verify-password-reset-otp":{"post":{"description":"Verify OTP code for password reset and receive reset token","operationId":"AuthController_verifyPasswordResetOtp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyPasswordResetOtpDto"}}}},"responses":{"200":{"description":"OTP verified. Returns reset token."},"400":{"description":"Invalid or expired OTP"}},"summary":"Verify password reset OTP","tags":["Authentication"]}},"/auth/reset-password":{"post":{"description":"Reset password using the reset token received from verify-password-reset-otp","operationId":"AuthController_resetPassword","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResetPasswordDto"}}}},"responses":{"200":{"description":"Password reset successfully"},"401":{"description":"Invalid or expired reset token"}},"summary":"Reset password","tags":["Authentication"]}},"/auth/complete-profile":{"post":{"description":"Complete profile information after first login. Requires authentication.","operationId":"AuthController_completeProfile","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CompleteProfileDto"}}}},"responses":{"200":{"description":"Profile completed successfully"},"400":{"description":"Profile already completed or validation failed"},"401":{"description":"Unauthorized - Invalid or missing token"}},"security":[{"access-token":[]}],"summary":"Complete user profile","tags":["Authentication"]}},"/otp/verify":{"post":{"description":"Verify OTP code. Requires either email or phone to identify the verification medium. Note: This is a low-level endpoint. Use auth/verify-otp for authentication flow.","operationId":"OtpController_verifyOtp","parameters":[{"name":"x-forwarded-for","in":"header","description":"Client IP address (optional, can also be detected automatically)","required":false,"schema":{"type":"string"}},{"name":"x-device-id","in":"header","description":"Device ID (optional)","required":false,"schema":{"type":"string"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/VerifyOtpDto"}}}},"responses":{"200":{"description":"OTP verified successfully"},"400":{"description":"Invalid, expired, or already used OTP, or email/phone mismatch"}},"summary":"Verify OTP","tags":["OTP"]}},"/otp/resend":{"post":{"description":"Resend OTP code for phone or email. Supports both login and password reset purposes. Invalidates any existing unused OTPs for the specified purpose and sends a new one.","operationId":"OtpController_resendOtp","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResendOtpDto"}}}},"responses":{"200":{"description":"OTP resent successfully","content":{"application/json":{"schema":{"type":"object","properties":{"otpId":{"type":"string","description":"New OTP ID for verification"},"userId":{"type":"string","description":"User ID"},"message":{"type":"string","example":"OTP resent successfully"}}}}}},"400":{"description":"Invalid request or validation failed"},"404":{"description":"User not found"}},"summary":"Resend OTP","tags":["OTP"]}},"/questionnaire":{"get":{"description":"Retrieve all active questionnaires, optionally filtered by type","operationId":"QuestionnaireController_getQuestionnaires","parameters":[{"name":"type","required":true,"in":"query","description":"Questionnaire type (user or advisor)","schema":{"type":"string","enum":["user","advisor"]}}],"responses":{"200":{"description":"Questionnaires retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/QuestionnaireResponseDto"}}}}}},"summary":"Get all active questionnaires","tags":["Questionnaire"]}},"/questionnaire/for-user":{"get":{"description":"Get questionnaires that should be shown to the user based on their profile","operationId":"QuestionnaireController_getQuestionnairesForUser","parameters":[],"responses":{"200":{"description":"Questionnaires retrieved successfully","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/QuestionnaireResponseDto"}}}}}},"security":[{"access-token":[]}],"summary":"Get questionnaires for current user","tags":["Questionnaire"]}},"/questionnaire/{id}":{"get":{"description":"Retrieve a specific questionnaire with all questions and options","operationId":"QuestionnaireController_getQuestionnaireById","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Questionnaire retrieved successfully"},"404":{"description":"Questionnaire not found"}},"summary":"Get questionnaire by ID","tags":["Questionnaire"]}},"/questionnaire/{id}/progress":{"get":{"description":"Get user progress for a specific questionnaire","operationId":"QuestionnaireController_getProgress","parameters":[{"name":"id","required":true,"in":"path","schema":{"type":"string"}}],"responses":{"200":{"description":"Progress retrieved successfully"}},"security":[{"access-token":[]}],"summary":"Get questionnaire progress","tags":["Questionnaire"]}},"/questionnaire/answers/my":{"get":{"description":"Retrieve all answers submitted by the current user","operationId":"QuestionnaireController_getMyAnswers","parameters":[{"name":"questionnaireId","required":true,"in":"query","schema":{"type":"string"}}],"responses":{"200":{"description":"Answers retrieved successfully"}},"security":[{"access-token":[]}],"summary":"Get my answers","tags":["Questionnaire"]}},"/questionnaire/answer":{"post":{"description":"Submit an answer to a question","operationId":"QuestionnaireController_submitAnswer","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubmitAnswerDto"}}}},"responses":{"200":{"description":"Answer submitted successfully"},"400":{"description":"Invalid answer or validation failed"},"404":{"description":"Question not found"}},"security":[{"access-token":[]}],"summary":"Submit answer","tags":["Questionnaire"]}},"/questionnaire/answers":{"post":{"description":"Submit multiple answers at once","operationId":"QuestionnaireController_submitAnswers","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/SubmitAnswerDto"}}}}},"responses":{"200":{"description":"Answers submitted successfully"}},"security":[{"access-token":[]}],"summary":"Submit multiple answers","tags":["Questionnaire"]}},"/questionnaire/step":{"post":{"description":"Submit answers for a specific step. When the last step is submitted and all required questions are answered, the questionnaire will be marked as completed.","operationId":"QuestionnaireController_submitStep","parameters":[],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SubmitStepDto"}}}},"responses":{"200":{"description":"Step answers submitted successfully","content":{"application/json":{"schema":{"type":"object","properties":{"answers":{"type":"array","description":"Submitted answers"},"isLastStep":{"type":"boolean","description":"Whether this was the last step"},"questionnaireCompleted":{"type":"boolean","description":"Whether the questionnaire is now completed"}}}}}},"400":{"description":"Invalid step or questionnaire already completed"},"404":{"description":"Questionnaire or user not found"}},"security":[{"access-token":[]}],"summary":"Submit step answers","tags":["Questionnaire"]}}},"info":{"title":"SideKix Backend","description":"Auth + other APIs","version":"1.0","contact":{}},"tags":[],"servers":[],"components":{"securitySchemes":{"access-token":{"scheme":"bearer","bearerFormat":"JWT","type":"http"}},"schemas":{"LoginDto":{"type":"object","properties":{"type":{"type":"string","description":"Login type / provider","enum":["google","apple","phone","email"],"example":"phone"},"phone":{"type":"string","description":"Phone number in E.164 format (required for phone login)","example":"+919999999999"},"email":{"type":"string","description":"Email (required for email login)","example":"alice@example.com"},"password":{"type":"string","description":"Password (required for email login)","example":"P@ssw0rd!"}},"required":["type"]},"SocialLoginDto":{"type":"object","properties":{"type":{"type":"string","description":"Login type / provider","enum":["google","apple","phone","email"],"example":"google"},"idToken":{"type":"string","description":"Google ID token from client","example":"eyJhbGci..."}},"required":["type","idToken"]},"RequestPasswordResetDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address of the user","example":"user@example.com"}},"required":["email"]},"VerifyPasswordResetOtpDto":{"type":"object","properties":{"email":{"type":"string","description":"Email address of the user","example":"user@example.com"},"otpId":{"type":"string","description":"OTP ID received from request password reset","example":"123e4567-e89b-12d3-a456-426614174000"},"code":{"type":"string","description":"OTP code received via email","example":"123456"}},"required":["email","otpId","code"]},"ResetPasswordDto":{"type":"object","properties":{"resetToken":{"type":"string","description":"Reset token received from verify password reset OTP","example":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."},"newPassword":{"type":"string","description":"New password (minimum 6 characters)","example":"NewP@ssw0rd!"},"confirmPassword":{"type":"string","description":"Confirm password (must match new password)","example":"NewP@ssw0rd!"}},"required":["resetToken","newPassword","confirmPassword"]},"CompleteProfileDto":{"type":"object","properties":{"firstName":{"type":"string","description":"User first name","example":"John"},"lastName":{"type":"string","description":"User last name","example":"Doe"},"phone":{"type":"string","description":"Phone number in E.164 format","example":"+919999999999"},"email":{"type":"string","description":"Email address","example":"john.doe@example.com"},"isAdvisor":{"type":"boolean","description":"Whether user wants to apply as an advisor","example":true},"termsAccepted":{"type":"boolean","description":"Terms of Service acceptance (must be true)","example":true}},"required":["firstName","lastName","phone","email","isAdvisor","termsAccepted"]},"VerifyOtpDto":{"type":"object","properties":{"otpId":{"type":"string","description":"OTP ID received from request OTP","example":"123e4567-e89b-12d3-a456-426614174000"},"code":{"type":"string","description":"OTP code to verify","example":"123456"},"email":{"type":"string","description":"Email address (required if phone is not provided)","example":"user@example.com"},"phone":{"type":"string","description":"Phone number in E.164 format (required if email is not provided)","example":"+919999999999"}},"required":["otpId","code"]},"ResendOtpDto":{"type":"object","properties":{"purpose":{"type":"string","description":"OTP purpose - login or reset","enum":["login","reset"],"example":"login"},"type":{"type":"string","description":"Login type / provider","enum":["google","apple","phone","email"],"example":"phone"},"phone":{"type":"string","description":"Phone number in E.164 format (required for phone)","example":"+919999999999"},"email":{"type":"string","description":"Email (required for email type)","example":"alice@example.com"}},"required":["purpose","type"]},"QuestionOptionResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"label":{"type":"string","example":"I have a business idea"},"value":{"type":"string","example":"i_have_a_business_idea"},"displayOrder":{"type":"number","example":1}},"required":["id","label","displayOrder"]},"QuestionResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"text":{"type":"string","example":"What brings you here?"},"subtitle":{"type":"string","example":"Select all that apply"},"type":{"type":"string","enum":["text","textarea","single_choice","multiple_choice","file_upload"],"example":"single_choice","description":"Question type (single_choice, multiple_choice, text, textarea, file_upload)"},"displayStyle":{"type":"string","enum":["radio","checkbox","tab","text_input","textarea","file_upload"],"example":"radio","description":"Display style determines the exact UI component: radio = radio buttons, checkbox = checkboxes, tab = tabs/tags, text_input = text input, textarea = textarea, file_upload = file upload"},"isRequired":{"type":"boolean","example":true},"stepNumber":{"type":"number","example":1},"displayOrder":{"type":"number","example":1},"options":{"type":"array","items":{"$ref":"#/components/schemas/QuestionOptionResponseDto"}},"validation":{"type":"object","example":{"minLength":10,"maxLength":1000},"description":"Validation rules for text/textarea questions"}},"required":["id","text","type","isRequired","stepNumber","displayOrder"]},"QuestionnaireResponseDto":{"type":"object","properties":{"id":{"type":"string","example":"123e4567-e89b-12d3-a456-426614174000"},"title":{"type":"string","example":"Welcome to Sidekix"},"description":{"type":"string","example":"Help us understand your needs"},"type":{"type":"string","example":"user"},"questions":{"type":"array","items":{"$ref":"#/components/schemas/QuestionResponseDto"}}},"required":["id","title","type","questions"]},"SubmitAnswerDto":{"type":"object","properties":{"questionId":{"type":"string","description":"Question ID","example":"123e4567-e89b-12d3-a456-426614174000"},"textAnswer":{"type":"string","description":"Text answer (for text, textarea questions)","example":"I have a business idea"},"selectedOptions":{"description":"Selected option IDs (for single/multiple choice questions)","example":["option-id-1","option-id-2"],"type":"array","items":{"type":"string"}},"fileUrl":{"type":"string","description":"File URL (for file upload questions)","example":"https://example.com/resume.pdf"},"fileName":{"type":"string","description":"File name (for file upload questions)","example":"resume.pdf"}},"required":["questionId"]},"SubmitStepDto":{"type":"object","properties":{"questionnaireId":{"type":"string","description":"Questionnaire ID","example":"123e4567-e89b-12d3-a456-426614174000"},"stepNumber":{"type":"number","description":"Step number","example":1},"answers":{"description":"Answers for all questions in this step","type":"array","items":{"$ref":"#/components/schemas/SubmitAnswerDto"}}},"required":["questionnaireId","stepNumber","answers"]}}}}